<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ruoyi.position.mapper.SysPositionInfoMapper">

    <resultMap type="SysPositionInfo" id="SysPositionInfoResult">
        <result property="id" column="id"/>
        <result property="positionCode" column="position_code"/>
        <result property="positionTitle" column="position_title"/>
        <result property="companyId" column="company_id"/>
        <result property="companyName" column="company_name"/>
        <result property="positionDescription" column="position_description"/>
        <result property="responsibilities" column="responsibilities"/>
        <result property="requirements" column="requirements"/>
        <result property="salaryMin" column="salary_min"/>
        <result property="salaryMax" column="salary_max"/>
        <result property="salaryUnit" column="salary_unit"/>
        <result property="benefits" column="benefits"/>
        <result property="workLocation" column="work_location"/>
        <result property="workType" column="work_type"/>
        <result property="workExperience" column="work_experience"/>
        <result property="educationRequired" column="education_required"/>
        <result property="skillsRequired" column="skills_required"/>
        <result property="industryTags" column="industry_tags"/>
        <result property="positionTags" column="position_tags"/>
        <result property="recruitNum" column="recruit_num"/>
        <result property="urgencyLevel" column="urgency_level"/>
        <result property="status" column="status"/>
        <result property="publishTime" column="publish_time"/>
        <result property="deadlineTime" column="deadline_time"/>
        <result property="closeReason" column="close_reason"/>
        <result property="viewCount" column="view_count"/>
        <result property="applyCount" column="apply_count"/>
        <result property="interviewCount" column="interview_count"/>
        <result property="hireCount" column="hire_count"/>
        <result property="contactPerson" column="contact_person"/>
        <result property="contactPhone" column="contact_phone"/>
        <result property="contactEmail" column="contact_email"/>
        <result property="createDept" column="create_dept"/>
        <result property="createBy" column="create_by"/>
        <result property="createTime" column="create_time"/>
        <result property="updateBy" column="update_by"/>
        <result property="updateTime" column="update_time"/>
        <result property="remark" column="remark"/>
    </resultMap>

    <resultMap id="SysPositionInfoSysPositionRequirementResult" type="SysPositionInfo" extends="SysPositionInfoResult">
        <collection property="sysPositionRequirementList" ofType="SysPositionRequirement" column="id"
                    select="selectSysPositionRequirementList"/>
    </resultMap>

    <resultMap type="SysPositionRequirement" id="SysPositionRequirementResult">
        <result property="id" column="id"/>
        <result property="positionId" column="position_id"/>
        <result property="ageMin" column="age_min"/>
        <result property="ageMax" column="age_max"/>
        <result property="genderRequirement" column="gender_requirement"/>
        <result property="languageRequirements" column="language_requirements"/>
        <result property="certificateRequirements" column="certificate_requirements"/>
        <result property="travelRequirement" column="travel_requirement"/>
        <result property="overtimeAcceptable" column="overtime_acceptable"/>
        <result property="preferredExperience" column="preferred_experience"/>
        <result property="preferredSkills" column="preferred_skills"/>
        <result property="preferredBackground" column="preferred_background"/>
        <result property="createTime" column="create_time"/>
        <result property="updateTime" column="update_time"/>
    </resultMap>

    <sql id="selectSysPositionInfoVo">
        select id,
               position_code,
               position_title,
               company_id,
               company_name,
               position_description,
               responsibilities,
               requirements,
               salary_min,
               salary_max,
               salary_unit,
               benefits,
               work_location,
               work_type,
               work_experience,
               education_required,
               skills_required,
               industry_tags,
               position_tags,
               recruit_num,
               urgency_level,
               status,
               publish_time,
               deadline_time,
               close_reason,
               view_count,
               apply_count,
               interview_count,
               hire_count,
               contact_person,
               contact_phone,
               contact_email,
               create_dept,
               create_by,
               create_time,
               update_by,
               update_time,
               remark
        from sys_position_info
    </sql>

    <select id="selectSysPositionInfoList" parameterType="SysPositionInfo" resultMap="SysPositionInfoResult">
        <include refid="selectSysPositionInfoVo"/>
        <where>
            <if test="positionCode != null  and positionCode != ''">and position_code = #{positionCode}</if>
            <if test="positionTitle != null  and positionTitle != ''">and position_title = #{positionTitle}</if>
            <if test="companyId != null ">and company_id = #{companyId}</if>
            <if test="companyName != null  and companyName != ''">and company_name like concat('%', #{companyName},
                '%')
            </if>
            <if test="positionDescription != null  and positionDescription != ''">and position_description =
                #{positionDescription}
            </if>
            <if test="responsibilities != null  and responsibilities != ''">and responsibilities = #{responsibilities}
            </if>
            <if test="requirements != null  and requirements != ''">and requirements = #{requirements}</if>
            <if test="salaryMin != null ">and salary_min = #{salaryMin}</if>
            <if test="salaryMax != null ">and salary_max = #{salaryMax}</if>
            <if test="salaryUnit != null  and salaryUnit != ''">and salary_unit = #{salaryUnit}</if>
            <if test="benefits != null  and benefits != ''">and benefits = #{benefits}</if>
            <if test="workLocation != null  and workLocation != ''">and work_location = #{workLocation}</if>
            <if test="workType != null  and workType != ''">and work_type = #{workType}</if>
            <if test="workExperience != null  and workExperience != ''">and work_experience = #{workExperience}</if>
            <if test="educationRequired != null  and educationRequired != ''">and education_required =
                #{educationRequired}
            </if>
            <if test="skillsRequired != null  and skillsRequired != ''">and skills_required = #{skillsRequired}</if>
            <if test="industryTags != null  and industryTags != ''">and industry_tags = #{industryTags}</if>
            <if test="positionTags != null  and positionTags != ''">and position_tags = #{positionTags}</if>
            <if test="recruitNum != null ">and recruit_num = #{recruitNum}</if>
            <if test="urgencyLevel != null  and urgencyLevel != ''">and urgency_level = #{urgencyLevel}</if>
            <if test="status != null  and status != ''">and status = #{status}</if>
            <if test="publishTime != null ">and publish_time = #{publishTime}</if>
            <if test="deadlineTime != null ">and deadline_time = #{deadlineTime}</if>
            <if test="closeReason != null  and closeReason != ''">and close_reason = #{closeReason}</if>
            <if test="viewCount != null ">and view_count = #{viewCount}</if>
            <if test="applyCount != null ">and apply_count = #{applyCount}</if>
            <if test="interviewCount != null ">and interview_count = #{interviewCount}</if>
            <if test="hireCount != null ">and hire_count = #{hireCount}</if>
            <if test="contactPerson != null  and contactPerson != ''">and contact_person = #{contactPerson}</if>
            <if test="contactPhone != null  and contactPhone != ''">and contact_phone = #{contactPhone}</if>
            <if test="contactEmail != null  and contactEmail != ''">and contact_email = #{contactEmail}</if>
            <if test="createDept != null ">and create_dept = #{createDept}</if>
        </where>
    </select>

    <select id="selectSysPositionInfoById" parameterType="Long" resultMap="SysPositionInfoSysPositionRequirementResult">
        select id,
               tenant_id,
               position_code,
               position_title,
               company_id,
               company_name,
               position_description,
               responsibilities,
               requirements,
               salary_min,
               salary_max,
               salary_unit,
               benefits,
               work_location,
               work_type,
               work_experience,
               education_required,
               skills_required,
               industry_tags,
               position_tags,
               recruit_num,
               urgency_level,
               status,
               publish_time,
               deadline_time,
               close_reason,
               view_count,
               apply_count,
               interview_count,
               hire_count,
               contact_person,
               contact_phone,
               contact_email,
               create_dept,
               create_by,
               create_time,
               update_by,
               update_time,
               remark
        from sys_position_info
        where id = #{id}
    </select>

    <select id="selectSysPositionRequirementList" resultMap="SysPositionRequirementResult">
        select id,
               position_id,
               age_min,
               age_max,
               gender_requirement,
               language_requirements,
               certificate_requirements,
               travel_requirement,
               overtime_acceptable,
               preferred_experience,
               preferred_skills,
               preferred_background,
               create_time,
               update_time
        from sys_position_requirement
        where position_id = #{position_id}
    </select>

    <insert id="insertSysPositionInfo" parameterType="SysPositionInfo" useGeneratedKeys="true" keyProperty="id">
        insert into sys_position_info
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="positionCode != null">position_code,</if>
            <if test="positionTitle != null and positionTitle != ''">position_title,</if>
            <if test="companyId != null">company_id,</if>
            <if test="companyName != null">company_name,</if>
            <if test="positionDescription != null">position_description,</if>
            <if test="responsibilities != null">responsibilities,</if>
            <if test="requirements != null">requirements,</if>
            <if test="salaryMin != null">salary_min,</if>
            <if test="salaryMax != null">salary_max,</if>
            <if test="salaryUnit != null">salary_unit,</if>
            <if test="benefits != null">benefits,</if>
            <if test="workLocation != null">work_location,</if>
            <if test="workType != null">work_type,</if>
            <if test="workExperience != null">work_experience,</if>
            <if test="educationRequired != null">education_required,</if>
            <if test="skillsRequired != null">skills_required,</if>
            <if test="industryTags != null">industry_tags,</if>
            <if test="positionTags != null">position_tags,</if>
            <if test="recruitNum != null">recruit_num,</if>
            <if test="urgencyLevel != null">urgency_level,</if>
            <if test="status != null">status,</if>
            <if test="publishTime != null">publish_time,</if>
            <if test="deadlineTime != null">deadline_time,</if>
            <if test="closeReason != null">close_reason,</if>
            <if test="viewCount != null">view_count,</if>
            <if test="applyCount != null">apply_count,</if>
            <if test="interviewCount != null">interview_count,</if>
            <if test="hireCount != null">hire_count,</if>
            <if test="contactPerson != null">contact_person,</if>
            <if test="contactPhone != null">contact_phone,</if>
            <if test="contactEmail != null">contact_email,</if>
            <if test="createDept != null">create_dept,</if>
            <if test="createBy != null">create_by,</if>
            <if test="createTime != null">create_time,</if>
            <if test="updateBy != null">update_by,</if>
            <if test="updateTime != null">update_time,</if>
            <if test="remark != null">remark,</if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="positionCode != null">#{positionCode},</if>
            <if test="positionTitle != null and positionTitle != ''">#{positionTitle},</if>
            <if test="companyId != null">#{companyId},</if>
            <if test="companyName != null">#{companyName},</if>
            <if test="positionDescription != null">#{positionDescription},</if>
            <if test="responsibilities != null">#{responsibilities},</if>
            <if test="requirements != null">#{requirements},</if>
            <if test="salaryMin != null">#{salaryMin},</if>
            <if test="salaryMax != null">#{salaryMax},</if>
            <if test="salaryUnit != null">#{salaryUnit},</if>
            <if test="benefits != null">#{benefits},</if>
            <if test="workLocation != null">#{workLocation},</if>
            <if test="workType != null">#{workType},</if>
            <if test="workExperience != null">#{workExperience},</if>
            <if test="educationRequired != null">#{educationRequired},</if>
            <if test="skillsRequired != null">#{skillsRequired},</if>
            <if test="industryTags != null">#{industryTags},</if>
            <if test="positionTags != null">#{positionTags},</if>
            <if test="recruitNum != null">#{recruitNum},</if>
            <if test="urgencyLevel != null">#{urgencyLevel},</if>
            <if test="status != null">#{status},</if>
            <if test="publishTime != null">#{publishTime},</if>
            <if test="deadlineTime != null">#{deadlineTime},</if>
            <if test="closeReason != null">#{closeReason},</if>
            <if test="viewCount != null">#{viewCount},</if>
            <if test="applyCount != null">#{applyCount},</if>
            <if test="interviewCount != null">#{interviewCount},</if>
            <if test="hireCount != null">#{hireCount},</if>
            <if test="contactPerson != null">#{contactPerson},</if>
            <if test="contactPhone != null">#{contactPhone},</if>
            <if test="contactEmail != null">#{contactEmail},</if>
            <if test="createDept != null">#{createDept},</if>
            <if test="createBy != null">#{createBy},</if>
            <if test="createTime != null">#{createTime},</if>
            <if test="updateBy != null">#{updateBy},</if>
            <if test="updateTime != null">#{updateTime},</if>
            <if test="remark != null">#{remark},</if>
        </trim>
    </insert>

    <update id="updateSysPositionInfo" parameterType="SysPositionInfo">
        update sys_position_info
        <trim prefix="SET" suffixOverrides=",">
            <if test="positionCode != null">position_code = #{positionCode},</if>
            <if test="positionTitle != null and positionTitle != ''">position_title = #{positionTitle},</if>
            <if test="companyId != null">company_id = #{companyId},</if>
            <if test="companyName != null">company_name = #{companyName},</if>
            <if test="positionDescription != null">position_description = #{positionDescription},</if>
            <if test="responsibilities != null">responsibilities = #{responsibilities},</if>
            <if test="requirements != null">requirements = #{requirements},</if>
            <if test="salaryMin != null">salary_min = #{salaryMin},</if>
            <if test="salaryMax != null">salary_max = #{salaryMax},</if>
            <if test="salaryUnit != null">salary_unit = #{salaryUnit},</if>
            <if test="benefits != null">benefits = #{benefits},</if>
            <if test="workLocation != null">work_location = #{workLocation},</if>
            <if test="workType != null">work_type = #{workType},</if>
            <if test="workExperience != null">work_experience = #{workExperience},</if>
            <if test="educationRequired != null">education_required = #{educationRequired},</if>
            <if test="skillsRequired != null">skills_required = #{skillsRequired},</if>
            <if test="industryTags != null">industry_tags = #{industryTags},</if>
            <if test="positionTags != null">position_tags = #{positionTags},</if>
            <if test="recruitNum != null">recruit_num = #{recruitNum},</if>
            <if test="urgencyLevel != null">urgency_level = #{urgencyLevel},</if>
            <if test="status != null">status = #{status},</if>
            <if test="publishTime != null">publish_time = #{publishTime},</if>
            <if test="deadlineTime != null">deadline_time = #{deadlineTime},</if>
            <if test="closeReason != null">close_reason = #{closeReason},</if>
            <if test="viewCount != null">view_count = #{viewCount},</if>
            <if test="applyCount != null">apply_count = #{applyCount},</if>
            <if test="interviewCount != null">interview_count = #{interviewCount},</if>
            <if test="hireCount != null">hire_count = #{hireCount},</if>
            <if test="contactPerson != null">contact_person = #{contactPerson},</if>
            <if test="contactPhone != null">contact_phone = #{contactPhone},</if>
            <if test="contactEmail != null">contact_email = #{contactEmail},</if>
            <if test="createDept != null">create_dept = #{createDept},</if>
            <if test="createBy != null">create_by = #{createBy},</if>
            <if test="createTime != null">create_time = #{createTime},</if>
            <if test="updateBy != null">update_by = #{updateBy},</if>
            <if test="updateTime != null">update_time = #{updateTime},</if>
            <if test="remark != null">remark = #{remark},</if>
        </trim>
        where id = #{id}
    </update>

    <delete id="deleteSysPositionInfoById" parameterType="Long">
        delete
        from sys_position_info
        where id = #{id}
    </delete>

    <delete id="deleteSysPositionInfoByIds" parameterType="String">
        delete from sys_position_info where id in
        <foreach item="id" collection="array" open="(" separator="," close=")">
            #{id}
        </foreach>
    </delete>

    <delete id="deleteSysPositionRequirementByPositionIds" parameterType="String">
        delete from sys_position_requirement where position_id in
        <foreach item="positionId" collection="array" open="(" separator="," close=")">
            #{positionId}
        </foreach>
    </delete>

    <delete id="deleteSysPositionRequirementByPositionId" parameterType="Long">
        delete
        from sys_position_requirement
        where position_id = #{positionId}
    </delete>

    <insert id="batchSysPositionRequirement">
        insert into sys_position_requirement( id, position_id, age_min, age_max, gender_requirement,
        language_requirements, certificate_requirements, travel_requirement, overtime_acceptable, preferred_experience,
        preferred_skills, preferred_background, create_time, update_time) values
        <foreach item="item" index="index" collection="list" separator=",">
            ( #{item.id}, #{item.positionId}, #{item.ageMin}, #{item.ageMax}, #{item.genderRequirement},
            #{item.languageRequirements}, #{item.certificateRequirements}, #{item.travelRequirement},
            #{item.overtimeAcceptable}, #{item.preferredExperience}, #{item.preferredSkills},
            #{item.preferredBackground}, #{item.createTime}, #{item.updateTime})
        </foreach>
    </insert>
</mapper>